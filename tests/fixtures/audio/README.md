# Test Audio Fixtures

This directory contains synthetic audio files for testing the voice assistant.

## Files

### Silence Files
- **silence_2s.flac/wav** - 2 seconds of silence
  - Purpose: Test silence detection in VAD

### Tone Files
- **tone_440hz_2s.flac/wav** - 440 Hz pure sine wave, 2 seconds
  - Purpose: Test audio path works (not for STT)

### Speech-Like Files (Synthetic)
- **speech_like_2s.flac/wav** - Speech-like audio, 2 seconds
  - Purpose: General STT pipeline testing
  - Note: Synthetic (not real speech), useful for testing audio flow

- **speech_short_1s.flac/wav** - Short speech-like audio, 1 second
  - Purpose: Quick tests with minimal audio

- **speech_long_5s.flac/wav** - Long speech-like audio, 5 seconds
  - Purpose: Test longer transcriptions

### Volume Variation Files
- **speech_low_volume.flac/wav** - Low amplitude speech-like audio
  - Purpose: Test normalization (gain adjustment)

- **speech_high_volume.flac/wav** - High amplitude speech-like audio
  - Purpose: Test clipping detection and handling

### Stereo Files
- **speech_stereo_2s.flac/wav** - Stereo speech-like audio, 2 seconds
  - Purpose: Test channel handling (mono/stereo conversion)

## Audio Properties

- **Sample Rate:** 16000 Hz (standard for Whisper/STT)
- **Format:** FLAC (lossless) + WAV (compatibility)
- **Bit Depth:** 16-bit (WAV), 32-bit float (FLAC)
- **Channels:** Mono (except stereo variants)

## Generation

All audio files are generated by `generate_test_audio.py`:

```bash
python3 generate_test_audio.py
```

This ensures consistent, reproducible test audio without requiring real voice samples.

## Usage in Tests

```python
from pathlib import Path
import soundfile as sf

# Read test audio
audio_file = Path("tests/fixtures/audio/speech_short_1s.flac")
audio_data, sample_rate = sf.read(audio_file)

# Use in tests
stt_result = await stt_worker.transcribe(audio_data.tobytes())
```

## Notes

- **Not Real Speech:** These are synthetic audio files with speech-like characteristics
- **For Real STT Testing:** Use actual voice recordings if you want accurate transcription testing
- **For Pipeline Testing:** These files are excellent for testing the audio data flow
- **Generated:** Files are generated, not committed, to keep repo size small

## Regenerating Files

If you need to regenerate or modify test audio:

```bash
# Edit generate_test_audio.py
python3 generate_test_audio.py

# Verify new files
ls -lh tests/fixtures/audio/
```

## Testing Categories

| File Category | Test Target |
|---------------|-------------|
| Silence | VAD silence detection |
| Tone | Audio input/output path |
| Speech-like | STT transcription flow |
| Volume variants | Normalization, clipping |
| Stereo | Channel handling |

---

**Location:** `tests/fixtures/audio/`
**Sample Rate:** 16000 Hz
**Generated by:** `generate_test_audio.py`
**Last updated:** 2026-02-27 12:35 PST